
SELECT * FROM MOVIMIENTO
INSERT INTO MOVIMIENTO (DESCRIPCION) VALUES ('ABONO')
UPDATE MOVIMIENTO SET DESCRIPCION = 'ABONO' WHERE ID_MOVIMIENTO = 3
				drop database DBCONTROL;
				TRUNCATE TABLE RESUMEN;
				INSERT INTO RESUMEN (SALDO, ID_PROVEEDOR) VALUES (40.23,3)
				SELECT * FROM RESUMEN
				INSERT INTO MOVIMIENTO (DESCRIPCION) VALUES ('B')
                INSERT INTO ESTADO (DESCRIPCION) VALUES ('C')
                SELECT * FROM ESTADO;
                UPDATE ESTADO SET DESCRIPCION = 'EN FECHA' WHERE ID_ESTADO = 3
                INSERT INTO ESTADO (DESCRIPCION) VALUES ('POR VENCER')

                INSERT INTO PROVEEDOR (DESCRIPCION,NIT,PLAZO,ID_CLASIFICACION)
                VALUES ('PROVEEDOR B','325656-65',30,2)
                SELECT * FROM PROVEEDOR;

EXEC sp_dbcontrol_operacion_resta @p_accion = 'LSO'
EXEC sp_dbcontrol_operacion @p_accion = 'ADD',
@p_monto = 20.23,
@p_fecha_compra = '2021-08-15',
@p_fecha_pago = '2021-08-28',
@p_referencia = '43344',
@p_medio_pago = 'Efectivo',
@p_numero_documento = '1233',
@p_token = NULL,
@p_impuesto = 12,
@p_isr = 0,
@p_id_estado = NULL,
@p_id_movimiento = 2,
@p_id_proveedor = 2,
@p_operaciones = null,
@p_cuenta = null

EXEC sp_dbcontrol_operacion_resta @p_accion = 'ABN',
@p_monto = 10.00,
@p_fecha_compra = '2021-08-03',
@p_fecha_pago = '2021-08-28',
@p_referencia = '43344',
@p_medio_pago = 'Efectivo',
@p_numero_documento = '1233',
@p_token = NULL,
@p_impuesto = 12,
@p_isr = 0,
@p_id_estado = NULL,
@p_id_movimiento = NULL,
@p_id_proveedor = 1,
@p_operaciones = null,
@p_cuenta = null

EXEC sp_dbcontrol_operacion_resta @p_accion = 'LST'
INSERT INTO CUENTA (SALDO,NOMBRE_EMPRESA,DIRECCION,TELEFONO) VALUES
('1000.00','TU CREDITO S,A.','VILLA NUEVA','412784477')

UPDATE CUENTA SET SALDO = '1000.00'

truncate table operacion
truncate table resumen
SELECT * FROM OPERACION
SELECT * from RESUMEN
SELECT * from CUENTA;
SELECT * FROM MOVIMIENTO;
SELECT * from PROVEEDOR

SELECT * FROM OPERACION
SELECT * FROM ESTADO
SELECT DATEDIFF(D,GETDATE(),'2021-08-15')
SELECT OP.ID_OPERACION
	,OP.FECHA_COMPRA
	,OP.FECHA_PAGO
	,OP.REFERENCIA
	,OP.NUM_DOCUMENTO
	,OP.TOKEN
	,OP.IMPUESTO_IVA
	,OP.IMPUESTO_ISR
    ,MV.DESCRIPCION AS MOVIMIENTO
    ,PR.DESCRIPCION AS PROVEEDOR
    ,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO) AS DIAS_RESTANTES
    ,(CASE
							WHEN CONVERT(INT,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO)) >= 30
								THEN 'MUY RETRASADO'
							WHEN CONVERT(INT,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO)) < 29
								AND CONVERT(INT,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO)) >= 15
								THEN 'ATRASADO'
							WHEN CONVERT(INT,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO)) < 15
								AND CONVERT(INT,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO)) >= 0
								THEN 'EN FECHA'
							WHEN CONVERT(INT,DATEDIFF(D,GETDATE(),OP.FECHA_PAGO)) < 0
								THEN 'POR VENCER'
							ELSE 'NO DEFINIDO'
							END
					) AS ESTADO
FROM OPERACION AS OP WITH (NOLOCK)
INNER JOIN PROVEEDOR AS PR WITH (NOLOCK)
	ON PR.ID_PROVEEDOR = OP.ID_PROVEEDOR
INNER JOIN MOVIMIENTO AS MV WITH (NOLOCK)
	ON MV.ID_MOVIMIENTO = OP.ID_MOVIMIENTO


SELECT PR.ID_PROVEEDOR
	,PR.DESCRIPCION
	,PR.NIT
	,PR.PLAZO
FROM RESUMEN AS RS WITH (NOLOCK)
INNER JOIN PROVEEDOR AS PR WITH (NOLOCK) ON
 PR.ID_PROVEEDOR = RS.ID_PROVEEDOR
